import numpy as np

def LisnImpedance():
    """Returns a vector containing the target impedance for MIL-STD-461G
    The impedance shall be measured into the LISN DUT port with a 50 Ohm load at the instrument port.
    Additional tolerance is +-20%.

    :return: f [Hz], R [Ohm]
    :rtype: ndarray, vector


    .. highlight:: python
    .. code-block:: python
    
        import matplotlib.pyplot as plt
        from rftool import LisnImpedance


        f, R = LisnImpedance()
        
        plt.semilogx(f, R)
        plt.grid()
        plt.show()
    """
    target = np.array([[0.15268649405147783, 4.572490706319712],
    [0.18665001853237406, 5.7620817843866305],
    [0.2365003434154119, 7.2490706319702625],
    [0.2849893694435159, 8.736059479553916],
    [0.3663219381849863, 11.115241635687745],
    [0.45754744766623034, 13.791821561338296],
    [0.5357620684224851, 15.873605947955397],
    [0.6596516327749962, 18.996282527881043],
    [0.7505668999772064, 21.52416356877324],
    [0.8540123958634243, 23.457249070631974],
    [1.0439785817666594, 27.39776951672863],
    [1.267079131708692, 30.96654275092937],
    [1.4836776817831183, 33.940520446096656],
    [1.7498090332270149, 36.98884758364313],
    [2.2653754353388873, 40.78066914498142],
    [2.749491215371472, 43.15985130111524],
    [4.079358752505394, 46.50557620817844],
    [3.434199693873259, 45.24163568773234],
    [5.553263571014869, 47.9182156133829],
    [7.2933717228838635, 48.81040892193309],
    [9.374813069860554, 49.182156133829],
    [11.709431910399605, 49.479553903345725],
    [19.909732294550228, 49.92565055762082],
    [15.82621083457176, 49.62825278810409],
    [1.1378231519260429, 29.033457249070636],
    [1.3909200922640779, 32.750929368029745],
    [1.6404132594456664, 35.65055762081785],
    [1.9909732294550238, 38.92193308550186]])
    target.view('float32,float32').sort(order=['f1'], axis=0)
    target[:,0] = target[:,0]*1e6 # convert to MHz
    R = target[:,1]
    f = target[:,0]
    return f, R